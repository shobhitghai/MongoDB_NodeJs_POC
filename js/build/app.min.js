/*! MongoDB_Node_POC 1.0.0 2015-06-23 */
function getDeviceState(){var a=window.getComputedStyle(document.querySelector(".state-indicator"),":before").getPropertyValue("content");return a=a.replace(/"/g,""),a=a.replace(/'/g,"")}(function(){this.app={}}).call(this),function(){app.config={hello:"world"}}(app);var indicator=document.createElement("div");indicator.className="state-indicator",document.body.appendChild(indicator),function(){window.console||(window.console={});for(var a=["log","info","warn","error","debug","trace","dir","group","groupCollapsed","groupEnd","time","timeEnd","profile","profileEnd","dirxml","assert","count","markTimeline","timeStamp","clear"],b=function(){},c=0;c<a.length;c++)window.console[a[c]]||(window.console[a[c]]=b)}(),$(function(){app.util.initModules()}),function(){app.util={initModules:function(a){var b=[],c=[],d='[class^="mod-"], [class*=" mod-"]';targets=$(d,a),a=$(a),0===a.length&&(a=$(document)),a.each(function(){$(this).filter(d).length&&(targets=targets.add($(this)))}),targets.each(function(){var a=$(this).prop("class").match(/mod-([^ ]+)/g);$.each(a,function(c){var d=a[c].replace("mod-","");app[d]&&b.push(d)})}),$.each(b,function(a,b){-1===$.inArray(b,c)&&c.push(b)}),b=c;var e=[];return $.each(b,function(c){app[b[c]].init?app[b[c]].settings.defer?e.push(b[c]):app[b[c]].init(a):console.log("initModule: The module '"+b[c]+"' does not have an init method")}),$.each(e,function(b){app[e[b]].init?app[e[b]].init(a):console.log("initModule: The module '"+e[b]+"' does not have an init method")}),b}}}(app),function(){app["tile-section"]={settings:{target:".mod-tile-section"},init:function(a){var b=App.Template.tile_opportunity,c=App.Template.tile_storeFront,d=App.Template.tile_dwellTime;App.Template.tile_customers;app["tile-section"].fetchData("getTotalCount",b,".section-opportunity"),app["tile-section"].fetchData("getContinentCount",c,".section-storeFront"),app["tile-section"].fetchData("getCountriesInContinent",d,".section-dwellTime",{country:"Asia"}),app["tile-section"].fetchData("getMostPopulatedCities","",".section-customers")},fetchData:function(a,b,c,d){$.ajax({url:"http://localhost:3001/api/"+a,data:d||{},success:function(a){b?app["tile-section"].bindTemplate(a,b,c):console.log(a)},error:function(a){console.log("err")}})},bindTemplate:function(a,b,c){var d=$.parseJSON(a);$(c).html(b({"tile-name":d.name,"tile-percent":d.data,"tile-percent-change":"","tile-period-param":d.desc}))}}}(app),function(){app["shopper-engagement"]={settings:{target:".mod-shopper-engagement"},init:function(a){var b=this.settings,c=$(b.target).find("#shopper-engagement-chart");app["shopper-engagement"].renderChart(c)},renderChart:function(a){a.highcharts({chart:{type:"bar",style:{fontFamily:"Arial"}},colors:["#a6a6a6","#55c6f2"],title:{text:""},xAxis:{categories:[">10 mins","5-20 mins","2-5 mins","bounced"],title:{text:null}},yAxis:{min:0,title:{text:""},labels:{overflow:"justify"}},tooltip:{valueSuffix:" millions"},plotOptions:{bar:{dataLabels:{enabled:!0}}},legend:{layout:"vertical",align:"right",verticalAlign:"top",x:-40,y:100,floating:!0,borderWidth:1,backgroundColor:Highcharts.theme&&Highcharts.theme.legendBackgroundColor||"#FFFFFF",shadow:!0},credits:{enabled:!1},series:[{name:"Last Month",data:[107,31,635,203]},{name:"This Month",data:[133,156,947,408]}]})}}}(app),function(){app["shopper-profile"]={settings:{target:".mod-shopper-profile"},init:function(a){var b=this.settings,c=$(b.target).find("#shopper-profile-chart");$.ajax({url:"http://localhost:3001/api/getMostPopulatedCities",success:function(a){app["shopper-profile"].renderChart(c,$.parseJSON(a))},error:function(a){console.log("err")}})},renderChart:function(a,b){var c=new Array;$.each(b.data,function(a,b){var d={};d.name=this.countryName,d.y=this.population,c.push(d)}),console.log(c),a.highcharts({chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,style:{fontFamily:"Arial"}},title:{text:""},tooltip:{formatter:function(){return"<b>"+this.point.name+": "+(this.y/1e9).toFixed(2)+" billions</b>"}},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0},series:{dataLabels:{enabled:!0,formatter:function(){return(this.y/1e9).toFixed(2)},distance:-30,color:"white"}}},legend:{itemMarginBottom:10},series:[{type:"pie",name:"Population",data:c}],credits:{enabled:!1}})}}}(app),function(){app["revisit-frequency"]={settings:{target:".mod-revisit-frequency"},init:function(a){var b=this.settings,c=$(b.target).find("#revisit-frequency-chart");app["revisit-frequency"].renderChart(c)},renderChart:function(a){a.highcharts({chart:{type:"pie",style:{fontFamily:"Arial"}},colors:["#b4c7e7","#0070c0","#55c6f2","#a9d18e","#f7d348","#767171"],title:{text:""},yAxis:{title:{text:"Total percent market share"}},plotOptions:{pie:{shadow:!1},series:{dataLabels:{enabled:!0,formatter:function(){return"test"},distance:-30,color:"white"}}},tooltip:{formatter:function(){return"<b>"+this.point.name+"</b>: "+this.y+" %"}},legend:{enabled:!0,layout:"vertical",align:"right",width:200,verticalAlign:"middle",useHTML:!0,itemMarginTop:10,itemMarginBottom:10,labelFormatter:function(){return'<div style="text-align: left; width:50px;float:right;">'+this.name+"</div>"}},series:[{name:"Browsers",data:[["0-2 weeks",10],["2-4 weeks",15],["1-3 months",10],["3-6 months",35],["6-1 months",10],["> 1 year",20]],size:"100%",innerSize:"60%",showInLegend:!0,dataLabels:{enabled:!1}}],credits:{enabled:!1}})}}}(app),function(){app["cross-store"]={settings:{target:".mod-cross-store"},init:function(a){var b=this.settings,c=$(b.target).find("#cross-store-chart");app["cross-store"].renderChart(c)},renderChart:function(a){a.highcharts({chart:{type:"column",style:{fontFamily:"Arial"}},title:{text:""},xAxis:{categories:["DLF Vasant Kunj","Brand Average"],crosshair:!0},tooltip:{headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="padding:0"><b>{point.y:.1f}%</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0},plotOptions:{column:{pointPadding:.2,borderWidth:0}},series:[{name:"Cross-store",data:[{y:49.9,color:"#a9d18e"},{y:71.5,color:"#55c6f2"}]}],credits:{enabled:!1}})}}}(app),function(){app["time-trend"]={settings:{target:".mod-time-trend"},init:function(a){var b=this.settings,c=$(b.target).find("#time-trend-chart");app["time-trend"].renderChart(c)},renderChart:function(a){a.highcharts({title:{text:"",style:{fontFamily:"Arial"}},xAxis:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},yAxis:{title:{text:"Walk-ins"},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:""},legend:{layout:"vertical",align:"right",verticalAlign:"middle",borderWidth:0},series:[{name:"Tokyo",data:[7,6.9,9.5,14.5,22,11,21.2,26.5,23.3,18.3,13.9,9.6]},{name:"New York",data:[-.2,.8,8,21,17,20,8,11.1,29.1,14.1,8.6,2.5]}],credits:{enabled:!1}})}}}(app),function(){app["right-now"]={settings:{target:".mod-right-now"},init:function(a){var b=this.settings,c=$(b.target).find("#shopper-area-chart");$.ajax({url:"http://localhost:3001/api/getCountiesByArea",success:function(a){app["right-now"].renderChart(c,$.parseJSON(a))},error:function(a){console.log("err")}})},renderChart:function(a,b){var c=new Array;$.each(b.data,function(a,b){var d={};d.name=this.countryName,d.y=this.areaInSqKm,c.push(d)}),console.log(c),a.highcharts({chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,style:{fontFamily:"Arial"}},title:{text:""},tooltip:{formatter:function(){return"<b>"+this.point.name+": "+(this.y/1e7).toFixed(2)+" cr sqKm</b>"}},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0},series:{dataLabels:{enabled:!0,formatter:function(){return(this.y/1e7).toFixed(2)},distance:-30,color:"white"}}},legend:{itemMarginBottom:10},series:[{type:"pie",name:"Population",data:c}],credits:{enabled:!1}})}}}(app),function(){app["internal-benchmarking"]={settings:{target:".mod-internal-benchmarking"},init:function(a){var b=this.settings;$(".benchmark-start-date").datepicker({}),$(".benchmark-end-date").datepicker({});var c=$(b.target).find("#walkins-chart");storeFront_chart=$(b.target).find("#storeFront-chart"),engagement_chart=$(b.target).find("#engagement-chart"),dwell_chart=$(b.target).find("#dwell-chart"),repeatCustomers_chart=$(b.target).find("#repeatCustomers-chart"),topCustomers_chart=$(b.target).find("#topCustomers-chart"),categoriesArr=["Your Store","This Mall/Area","Stores(same city tier)","Stores(All)"];var d={labelName:"Walk-ins",chartbaseMargin:20,containerName:c,dataArr:[{name:"Last Month",data:[107,31,635,203]}],colors:["#00b0f0"]},e={labelName:"Storefront conversion",chartbaseMargin:5,containerName:storeFront_chart,dataArr:[{name:"Last Month",data:[17,341,211,343]}],colors:["#f7d348"]},f={labelName:"Engagement levels",chartbaseMargin:5,containerName:engagement_chart,dataArr:[{name:"Last Month",data:[99,77,665,63]}],colors:["#92d050"]},g={labelName:"Dwell time",chartbaseMargin:20,containerName:dwell_chart,dataArr:[{name:"Last Month",data:[107,31,635,203]}],colors:["#0070c0"]},h={labelName:"Repeat customers",chartbaseMargin:5,containerName:repeatCustomers_chart,dataArr:[{name:"Last Month",data:[107,31,635,203]}],colors:["#ff6d60"]},i={labelName:"Top customers",chartbaseMargin:5,containerName:topCustomers_chart,dataArr:[{name:"Last Month",data:[107,31,635,203]}],colors:["#7030a0"]};app["internal-benchmarking"].renderChart(d),categoriesArr,app["internal-benchmarking"].renderChart(e,categoriesArr),app["internal-benchmarking"].renderChart(f,categoriesArr),app["internal-benchmarking"].renderChart(g,categoriesArr),app["internal-benchmarking"].renderChart(h,categoriesArr),app["internal-benchmarking"].renderChart(i,categoriesArr)},renderChart:function(a){var b=a.containerName;b.highcharts({chart:{type:"bar",style:{fontFamily:"Arial",fontSize:"12px"}},colors:a.colors,title:{text:a.labelName,align:"left",x:0,y:10,margin:a.chartbaseMargin},xAxis:{categories:categoriesArr,lineWidth:0,minorGridLineWidth:0,lineColor:"transparent",labels:{enabled:!1},minorTickLength:0,tickLength:0},yAxis:{lineWidth:0,minorGridLineWidth:0,lineColor:"transparent",gridLineColor:"transparent",labels:{enabled:!1},title:{text:""},minorTickLength:0,tickLength:0},tooltip:{valueSuffix:" millions"},plotOptions:{bar:{dataLabels:{enabled:!0}}},legend:{enabled:!1},credits:{enabled:!1},series:a.dataArr})}}}(app),function(){app["campaign-impact"]={settings:{target:".mod-campaign-impact"},init:function(a){var b=this.settings,c=$(b.target),d=c.find(".edit-btn"),e=c.find(".impact-edit"),f=c.find(".config-save, .config-cancel");d.on("click",function(){e.toggleClass("edit-active")}),f.on("click",function(){e.toggleClass("edit-active")}),$(".campaign-start-date").datepicker({}),$(".campaign-end-date").datepicker({})}}}(app),function(){app["modification-impact"]={settings:{target:".mod-modification-impact"},init:function(a){var b=this.settings,c=$(b.target),d=c.find(".edit-btn"),e=c.find(".impact-edit"),f=c.find(".config-save, .config-cancel");d.on("click",function(){e.toggleClass("edit-active")}),f.on("click",function(){e.toggleClass("edit-active")}),$(".storefront-start-date").datepicker({})}}}(app);